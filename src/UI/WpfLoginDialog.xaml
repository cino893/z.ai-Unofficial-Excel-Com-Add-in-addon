<Window x:Class="ZaiExcelAddin.UI.WpfLoginDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Width="400" Height="280"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        WindowStyle="ToolWindow"
        Background="#F0F2F5"
        FontFamily="Segoe UI, Segoe UI Emoji">

    <Window.Resources>
        <LinearGradientBrush x:Key="GreenGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#217346" Offset="0"/>
            <GradientStop Color="#1D6B3F" Offset="1"/>
        </LinearGradientBrush>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="52"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource GreenGradient}">
            <StackPanel Orientation="Horizontal" Margin="16,0" VerticalAlignment="Center">
                <Viewbox Width="28" Height="28" Margin="0,0,10,0">
                    <Canvas Width="32" Height="32">
                        <Path Fill="White" Opacity="0.95"
                              Data="M4,4 L28,4 L28,9.5 L14,24 L28,24 L28,28 L4,28 L4,22.5 L18,8 L4,8 Z"/>
                        <Ellipse Canvas.Left="24" Canvas.Top="2" Width="7" Height="7"
                                 Fill="#FFD93D" Opacity="0.9"/>
                    </Canvas>
                </Viewbox>
                <TextBlock x:Name="lblTitle" Text="Z.AI Login" FontSize="16" FontWeight="SemiBold"
                           Foreground="White" VerticalAlignment="Center"
                           FontFamily="Segoe UI, Segoe UI Emoji"/>
            </StackPanel>
        </Border>

        <!-- Content -->
        <StackPanel Grid.Row="1" Margin="20,16,20,16" VerticalAlignment="Center">
            <TextBlock x:Name="lblPrompt" Text="Enter your API key:" FontSize="13"
                       Foreground="#1C1E21" Margin="0,0,0,10" TextWrapping="Wrap"
                       FontFamily="Segoe UI, Segoe UI Emoji"/>

            <!-- Password input -->
            <Grid Height="36" Margin="0,0,0,8">
                <PasswordBox x:Name="txtKey" FontSize="13" Padding="10,6"
                             VerticalContentAlignment="Center"
                             BorderBrush="#D1D5DB" BorderThickness="1"
                             Background="White"/>
                <TextBox x:Name="txtKeyVisible" FontSize="13" Padding="10,6"
                         VerticalContentAlignment="Center"
                         BorderBrush="#D1D5DB" BorderThickness="1"
                         Background="White" Visibility="Collapsed"/>
            </Grid>

            <!-- Show key checkbox -->
            <CheckBox x:Name="chkShow" Content="Show key" FontSize="12"
                      Foreground="#65676B" Margin="0,0,0,16"
                      Checked="OnShowKeyChanged" Unchecked="OnShowKeyChanged"
                      FontFamily="Segoe UI, Segoe UI Emoji"/>

            <!-- Buttons -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="btnOk" Content="OK" Width="90" Height="34" Margin="0,0,8,0"
                        FontSize="13" FontWeight="SemiBold" Foreground="White" Cursor="Hand"
                        Click="OnOkClick">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="Bd" CornerRadius="6" Background="{StaticResource GreenGradient}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Bd" Property="Background">
                                        <Setter.Value>
                                            <SolidColorBrush Color="#2E8B57"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
                <Button x:Name="btnCancel" Content="Cancel" Width="90" Height="34"
                        FontSize="13" Foreground="#4B5563" Cursor="Hand"
                        Click="OnCancelClick">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="Bd" CornerRadius="6" Background="#E5E7EB"
                                    BorderBrush="#D1D5DB" BorderThickness="1">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Bd" Property="Background">
                                        <Setter.Value>
                                            <SolidColorBrush Color="#D1D5DB"/>
                                        </Setter.Value>
                                    </Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
            </StackPanel>
        </StackPanel>
    </Grid>
</Window>
